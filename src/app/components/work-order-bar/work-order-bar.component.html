<div
  class="work-order-bar"
  [ngClass]="statusClass"
  [class.menu-open]="isMenuOpen"
  [style.left.px]="left"
  [style.width.px]="width"
  role="listitem"
  [attr.aria-label]="'Work order: ' + workOrder.data.name + ', Status: ' + statusLabel"
>
  <span class="bar-name">{{ workOrder.data.name }}</span>
  <app-status-badge [status]="workOrder.data.status" />

  <div class="menu-wrapper">
    <button
      class="menu-button"
      [class.visible]="isMenuOpen"
      (click)="toggleMenu($event)"
      aria-label="Work order options"
    >
      <svg width="14" height="4" viewBox="0 0 14 4" fill="none">
        <circle cx="2" cy="2" r="1.5" fill="currentColor"/>
        <circle cx="7" cy="2" r="1.5" fill="currentColor"/>
        <circle cx="12" cy="2" r="1.5" fill="currentColor"/>
      </svg>
    </button>

    @if (isMenuOpen) {
      <div 
        class="dropdown-menu"
        role="menu"
        [style.top.px]="dropdownPosition.top"
        [style.left.px]="dropdownPosition.left"
      >
        <button class="dropdown-item" role="menuitem" aria-label="Edit work order" (click)="onEdit($event)">
          Edit
        </button>
        <button class="dropdown-item dropdown-item-delete" role="menuitem" aria-label="Delete work order" (click)="onDelete($event)">
          Delete
        </button>
      </div>
    }
  </div>
</div>
